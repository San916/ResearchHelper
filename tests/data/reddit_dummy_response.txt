[{"kind": "Listing", "data": {"after": null, "dist": 1, "modhash": "", "geo_filter": "", "children": [{"kind": "t3", "data": {"approved_at_utc": null, "subreddit": "cprogramming", "selftext": "So I\u2019m coding a calculator and trying to use realloc (it\u2019s not the only solution for my problem but I\u2019m trying to learn how to use it).\n\nIf you run realloc on an array pointer that wasn\u2019t defined using malloc, you get a warning. \n\nFor example\n\nint ARRAY[5];\n\nint *temp = realloc(&amp;ARRAY, sizeof(int) * num);\n\nWill produced a warning that memory wasn\u2019t allocated for ARRAY, but no error. I know how to allocate memory using malloc/calloc, but I want to know what\u2019s the difference in how the computer will process it? I assumed an array defined the standard way was technically just a shorthand for using malloc or calloc.", "user_reports": [], "saved": false, "mod_reason_title": null, "gilded": 0, "clicked": false, "title": "Question about realloc", "link_flair_richtext": [], "subreddit_name_prefixed": "r/cprogramming", "hidden": false, "pwls": 6, "link_flair_css_class": null, "downs": 0, "thumbnail_height": null, "top_awarded_type": null, "hide_score": false, "name": "t3_1lrkzjb", "quarantine": false, "link_flair_text_color": "dark", "upvote_ratio": 0.57, "author_flair_background_color": null, "subreddit_type": "public", "ups": 1, "total_awards_received": 0, "media_embed": {}, "thumbnail_width": null, "author_flair_template_id": null, "is_original_content": false, "author_fullname": "t2_5drfouex", "secure_media": null, "is_reddit_media_domain": false, "is_meta": false, "category": null, "secure_media_embed": {}, "link_flair_text": null, "can_mod_post": false, "score": 1, "approved_by": null, "is_created_from_ads_ui": false, "author_premium": false, "thumbnail": "self", "edited": false, "author_flair_css_class": null, "author_flair_richtext": [], "gildings": {}, "content_categories": null, "is_self": true, "mod_note": null, "created": 1751641545.0, "link_flair_type": "text", "wls": 6, "removed_by_category": null, "banned_by": null, "author_flair_type": "text", "domain": "self.cprogramming", "allow_live_comments": false, "selftext_html": "&lt;!-- SC_OFF --&gt;&lt;div class=\"md\"&gt;&lt;p&gt;So I\u2019m coding a calculator and trying to use realloc (it\u2019s not the only solution for my problem but I\u2019m trying to learn how to use it).&lt;/p&gt;\n\n&lt;p&gt;If you run realloc on an array pointer that wasn\u2019t defined using malloc, you get a warning. &lt;/p&gt;\n\n&lt;p&gt;For example&lt;/p&gt;\n\n&lt;p&gt;int ARRAY[5];&lt;/p&gt;\n\n&lt;p&gt;int *temp = realloc(&amp;amp;ARRAY, sizeof(int) * num);&lt;/p&gt;\n\n&lt;p&gt;Will produced a warning that memory wasn\u2019t allocated for ARRAY, but no error. I know how to allocate memory using malloc/calloc, but I want to know what\u2019s the difference in how the computer will process it? I assumed an array defined the standard way was technically just a shorthand for using malloc or calloc.&lt;/p&gt;\n&lt;/div&gt;&lt;!-- SC_ON --&gt;", "likes": null, "suggested_sort": null, "banned_at_utc": null, "view_count": null, "archived": false, "no_follow": false, "is_crosspostable": false, "pinned": false, "over_18": false, "all_awardings": [], "awarders": [], "media_only": false, "can_gild": false, "spoiler": false, "locked": false, "author_flair_text": null, "treatment_tags": [], "visited": false, "removed_by": null, "num_reports": null, "distinguished": null, "subreddit_id": "t5_2rzb3", "author_is_blocked": false, "mod_reason_by": null, "removal_reason": null, "link_flair_background_color": "", "id": "1lrkzjb", "is_robot_indexable": true, "num_duplicates": 0, "report_reasons": null, "author": "Icefrisbee", "discussion_type": null, "num_comments": 18, "send_replies": true, "media": null, "contest_mode": false, "author_patreon_flair": false, "author_flair_text_color": null, "permalink": "/r/cprogramming/comments/1lrkzjb/question_about_realloc/", "stickied": false, "url": "https://www.reddit.com/r/cprogramming/comments/1lrkzjb/question_about_realloc/", "subreddit_subscribers": 47066, "created_utc": 1751641545.0, "num_crossposts": 0, "mod_reports": [], "is_video": false}}], "before": null}}, {"kind": "Listing", "data": {"after": null, "dist": null, "modhash": "", "geo_filter": "", "children": [{"kind": "t1", "data": {"subreddit_id": "t5_2rzb3", "approved_at_utc": null, "author_is_blocked": false, "comment_type": null, "awarders": [], "mod_reason_by": null, "banned_by": null, "author_flair_type": "text", "total_awards_received": 0, "subreddit": "cprogramming", "author_flair_template_id": null, "likes": null, "replies": "", "user_reports": [], "saved": false, "id": "n1bxbr8", "banned_at_utc": null, "mod_reason_title": null, "gilded": 0, "archived": false, "collapsed_reason_code": null, "no_follow": false, "author": "iamemhn", "can_mod_post": false, "created_utc": 1751646771.0, "send_replies": true, "parent_id": "t3_1lrkzjb", "score": 9, "author_fullname": "t2_4dk3fhk", "approved_by": null, "mod_note": null, "all_awardings": [], "collapsed": false, "body": "The memory chunks used to store `ARRAY` lives either in static memory (data segment) or the stack, depending on it being a global variable or a local variable. Either way, it is *not* a dynamically allocated chunk of memory, so it *does not* live in the heap.\n\n`realloc` only works with memory chunks that live in the heap. The kind you request with `malloc/calloc`, and release with `free`.", "edited": false, "top_awarded_type": null, "author_flair_css_class": null, "name": "t1_n1bxbr8", "is_submitter": false, "downs": 0, "author_flair_richtext": [], "author_patreon_flair": false, "body_html": "&lt;div class=\"md\"&gt;&lt;p&gt;The memory chunks used to store &lt;code&gt;ARRAY&lt;/code&gt; lives either in static memory (data segment) or the stack, depending on it being a global variable or a local variable. Either way, it is &lt;em&gt;not&lt;/em&gt; a dynamically allocated chunk of memory, so it &lt;em&gt;does not&lt;/em&gt; live in the heap.&lt;/p&gt;\n\n&lt;p&gt;&lt;code&gt;realloc&lt;/code&gt; only works with memory chunks that live in the heap. The kind you request with &lt;code&gt;malloc/calloc&lt;/code&gt;, and release with &lt;code&gt;free&lt;/code&gt;.&lt;/p&gt;\n&lt;/div&gt;", "removal_reason": null, "collapsed_reason": null, "distinguished": null, "associated_award": null, "stickied": false, "author_premium": false, "can_gild": false, "gildings": {}, "unrepliable_reason": null, "author_flair_text_color": null, "score_hidden": false, "permalink": "/r/cprogramming/comments/1lrkzjb/question_about_realloc/n1bxbr8/", "subreddit_type": "public", "locked": false, "report_reasons": null, "created": 1751646771.0, "author_flair_text": null, "treatment_tags": [], "link_id": "t3_1lrkzjb", "subreddit_name_prefixed": "r/cprogramming", "controversiality": 0, "depth": 0, "author_flair_background_color": null, "collapsed_because_crowd_control": null, "mod_reports": [], "num_reports": null, "ups": 9}}, {"kind": "t1", "data": {"subreddit_id": "t5_2rzb3", "approved_at_utc": null, "author_is_blocked": false, "comment_type": null, "awarders": [], "mod_reason_by": null, "banned_by": null, "author_flair_type": "text", "total_awards_received": 0, "subreddit": "cprogramming", "author_flair_template_id": null, "likes": null, "replies": {"kind": "Listing", "data": {"after": null, "dist": null, "modhash": "", "geo_filter": "", "children": [{"kind": "more", "data": {"count": 0, "name": "t1__", "id": "_", "parent_id": "t1_n1de4km", "depth": 1, "children": []}}], "before": null}}, "user_reports": [], "saved": false, "id": "n1de4km", "banned_at_utc": null, "mod_reason_title": null, "gilded": 0, "archived": false, "collapsed_reason_code": null, "no_follow": false, "author": "tomysshadow", "can_mod_post": false, "created_utc": 1751663512.0, "send_replies": true, "parent_id": "t3_1lrkzjb", "score": 5, "author_fullname": "t2_rfviu", "approved_by": null, "mod_note": null, "all_awardings": [], "collapsed": false, "body": "The thing about the answers you're getting here is that, while typically true, they are also implementation details. Technically, C does not require that there needs to be a stack, or a heap, or any difference between them, or how malloc and realloc and free are to store the memory in any particular way. All it makes clear is that you are not supposed to mix and match.\n\nmalloc/realloc/free are one thing, and you can use those together. In C++ there is also new and delete, and you can use those together. On Windows you have HeapAlloc and HeapFree, and you can use those together... basically, it's the idea that whatever you use to create it, you should use the equal and opposite to destroy it. You didn't use malloc to create that variable, so you can't use realloc or free on it either! Those three functions are all part of the same \"set,\" that are only intended to be used with themselves.\n\nFrom a purist C programmer's perspective, this is all that actually matters. The fine details of why this doesn't work don't matter because it is documented that this is not guaranteed to work. Any deeper explanation as to why will depend on the compiler and platform, because it is up to the specific compiler you are using how malloc is implemented. \n\nBut the basic problem is that when you call malloc, there needs to be some way to _know_ that spot in memory is occupied. Otherwise, malloc could not know where there is still space in memory that it can give to you the next time you call it. So it has to do some kind of bookkeeping.\n\nThis is typically implemented by inserting a few bytes immediately _before_ the pointer that it gives to you, which basically says \"hey, the block of memory immediately following this is in use, so if you're looking for free memory skip over me!\" When you call free, it then removes those bytes so that it is clear the memory is free again. So it expects that \"marker\" to be there. And well, realloc basically just automates the process of calling free and malloc for you so they all expect that little marker to be there. \n\nThis is all not necessary when you create a variable without malloc, as you did, because the size of that variable is known at compile time, so it can be reserved \"up front\" so to speak, rather than at runtime when the program is already running. So it never goes through malloc, therefore it doesn't get that malloc \"marker,\" and if you pass it to a function expecting the marker to be there it won't know what to do", "edited": 1751665058.0, "top_awarded_type": null, "author_flair_css_class": null, "name": "t1_n1de4km", "is_submitter": false, "downs": 0, "author_flair_richtext": [], "author_patreon_flair": false, "body_html": "&lt;div class=\"md\"&gt;&lt;p&gt;The thing about the answers you&amp;#39;re getting here is that, while typically true, they are also implementation details. Technically, C does not require that there needs to be a stack, or a heap, or any difference between them, or how malloc and realloc and free are to store the memory in any particular way. All it makes clear is that you are not supposed to mix and match.&lt;/p&gt;\n\n&lt;p&gt;malloc/realloc/free are one thing, and you can use those together. In C++ there is also new and delete, and you can use those together. On Windows you have HeapAlloc and HeapFree, and you can use those together... basically, it&amp;#39;s the idea that whatever you use to create it, you should use the equal and opposite to destroy it. You didn&amp;#39;t use malloc to create that variable, so you can&amp;#39;t use realloc or free on it either! Those three functions are all part of the same &amp;quot;set,&amp;quot; that are only intended to be used with themselves.&lt;/p&gt;\n\n&lt;p&gt;From a purist C programmer&amp;#39;s perspective, this is all that actually matters. The fine details of why this doesn&amp;#39;t work don&amp;#39;t matter because it is documented that this is not guaranteed to work. Any deeper explanation as to why will depend on the compiler and platform, because it is up to the specific compiler you are using how malloc is implemented. &lt;/p&gt;\n\n&lt;p&gt;But the basic problem is that when you call malloc, there needs to be some way to &lt;em&gt;know&lt;/em&gt; that spot in memory is occupied. Otherwise, malloc could not know where there is still space in memory that it can give to you the next time you call it. So it has to do some kind of bookkeeping.&lt;/p&gt;\n\n&lt;p&gt;This is typically implemented by inserting a few bytes immediately &lt;em&gt;before&lt;/em&gt; the pointer that it gives to you, which basically says &amp;quot;hey, the block of memory immediately following this is in use, so if you&amp;#39;re looking for free memory skip over me!&amp;quot; When you call free, it then removes those bytes so that it is clear the memory is free again. So it expects that &amp;quot;marker&amp;quot; to be there. And well, realloc basically just automates the process of calling free and malloc for you so they all expect that little marker to be there. &lt;/p&gt;\n\n&lt;p&gt;This is all not necessary when you create a variable without malloc, as you did, because the size of that variable is known at compile time, so it can be reserved &amp;quot;up front&amp;quot; so to speak, rather than at runtime when the program is already running. So it never goes through malloc, therefore it doesn&amp;#39;t get that malloc &amp;quot;marker,&amp;quot; and if you pass it to a function expecting the marker to be there it won&amp;#39;t know what to do&lt;/p&gt;\n&lt;/div&gt;", "removal_reason": null, "collapsed_reason": null, "distinguished": null, "associated_award": null, "stickied": false, "author_premium": false, "can_gild": false, "gildings": {}, "unrepliable_reason": null, "author_flair_text_color": null, "score_hidden": false, "permalink": "/r/cprogramming/comments/1lrkzjb/question_about_realloc/n1de4km/", "subreddit_type": "public", "locked": false, "report_reasons": null, "created": 1751663512.0, "author_flair_text": null, "treatment_tags": [], "link_id": "t3_1lrkzjb", "subreddit_name_prefixed": "r/cprogramming", "controversiality": 0, "depth": 0, "author_flair_background_color": null, "collapsed_because_crowd_control": null, "mod_reports": [], "num_reports": null, "ups": 5}}, {"kind": "t1", "data": {"body": "No. Only a pointer to dynamically allocated memory or NULL pointer can be passed to realloc. Anything different violates language constraints and invokes UB. Never do that!\n\n\nYou can think about `realloc` as optimized malloc+memcpy+free which can occasionally be in-place.", "subreddit_id": "t5_2rzb3", "approved_at_utc": null, "author_is_blocked": false, "comment_type": null, "awarders": [], "mod_reason_by": null, "banned_by": null, "author_flair_type": "text", "total_awards_received": 0, "subreddit": "cprogramming", "author_flair_template_id": null, "likes": null, "replies": "", "user_reports": [], "saved": false, "id": "n1bgx6m", "banned_at_utc": null, "mod_reason_title": null, "gilded": 0, "archived": false, "collapsed_reason_code": null, "no_follow": false, "author": "tstanisl", "can_mod_post": false, "created_utc": 1751641825.0, "send_replies": true, "parent_id": "t3_1lrkzjb", "score": 6, "author_fullname": "t2_iv9m70qu", "approved_by": null, "mod_note": null, "all_awardings": [], "collapsed": false, "author_cakeday": true, "edited": false, "top_awarded_type": null, "author_flair_css_class": null, "name": "t1_n1bgx6m", "is_submitter": false, "downs": 0, "author_flair_richtext": [], "author_patreon_flair": false, "body_html": "&lt;div class=\"md\"&gt;&lt;p&gt;No. Only a pointer to dynamically allocated memory or NULL pointer can be passed to realloc. Anything different violates language constraints and invokes UB. Never do that!&lt;/p&gt;\n\n&lt;p&gt;You can think about &lt;code&gt;realloc&lt;/code&gt; as optimized malloc+memcpy+free which can occasionally be in-place.&lt;/p&gt;\n&lt;/div&gt;", "removal_reason": null, "collapsed_reason": null, "distinguished": null, "associated_award": null, "stickied": false, "author_premium": false, "can_gild": false, "gildings": {}, "unrepliable_reason": null, "author_flair_text_color": null, "score_hidden": false, "permalink": "/r/cprogramming/comments/1lrkzjb/question_about_realloc/n1bgx6m/", "subreddit_type": "public", "locked": false, "report_reasons": null, "created": 1751641825.0, "author_flair_text": null, "treatment_tags": [], "link_id": "t3_1lrkzjb", "subreddit_name_prefixed": "r/cprogramming", "controversiality": 0, "depth": 0, "author_flair_background_color": null, "collapsed_because_crowd_control": null, "mod_reports": [], "num_reports": null, "ups": 6}}, {"kind": "t1", "data": {"subreddit_id": "t5_2rzb3", "approved_at_utc": null, "author_is_blocked": false, "comment_type": null, "awarders": [], "mod_reason_by": null, "banned_by": null, "author_flair_type": "text", "total_awards_received": 0, "subreddit": "cprogramming", "author_flair_template_id": null, "likes": null, "replies": {"kind": "Listing", "data": {"after": null, "dist": null, "modhash": "", "geo_filter": "", "children": [{"kind": "more", "data": {"count": 0, "name": "t1__", "id": "_", "parent_id": "t1_n1bpjjo", "depth": 1, "children": []}}], "before": null}}, "user_reports": [], "saved": false, "id": "n1bpjjo", "banned_at_utc": null, "mod_reason_title": null, "gilded": 0, "archived": false, "collapsed_reason_code": null, "no_follow": true, "author": "jedijackattack1", "can_mod_post": false, "created_utc": 1751644404.0, "send_replies": true, "parent_id": "t3_1lrkzjb", "score": 2, "author_fullname": "t2_woue5", "approved_by": null, "mod_note": null, "all_awardings": [], "collapsed": false, "body": "So according to C there are 2 kinds of memory in ram. The stack (where local variables, function call chains, function arguments and return values live) and the heap (a larger area of memory that is managed by the programmer though malloc and free). When you allocated data on the heap with malloc you get back a pointer. What you don't see is the little bit of Metadata that exists just before that pointer which tells the system how much data was allocated. When you call free it looks into this Metadata to work out how much data has been allocated so it can free it. An array on the stack does not have this Metadata and will trip an error when trying. The array you have on the stack is just a series of bytes on the stack while one in the heap has the additional Metadata used by the malloc functions.\n\nIf you want to learn more I would read up on how the heap and stack work respectively in more detail.", "edited": false, "top_awarded_type": null, "author_flair_css_class": null, "name": "t1_n1bpjjo", "is_submitter": false, "downs": 0, "author_flair_richtext": [], "author_patreon_flair": false, "body_html": "&lt;div class=\"md\"&gt;&lt;p&gt;So according to C there are 2 kinds of memory in ram. The stack (where local variables, function call chains, function arguments and return values live) and the heap (a larger area of memory that is managed by the programmer though malloc and free). When you allocated data on the heap with malloc you get back a pointer. What you don&amp;#39;t see is the little bit of Metadata that exists just before that pointer which tells the system how much data was allocated. When you call free it looks into this Metadata to work out how much data has been allocated so it can free it. An array on the stack does not have this Metadata and will trip an error when trying. The array you have on the stack is just a series of bytes on the stack while one in the heap has the additional Metadata used by the malloc functions.&lt;/p&gt;\n\n&lt;p&gt;If you want to learn more I would read up on how the heap and stack work respectively in more detail.&lt;/p&gt;\n&lt;/div&gt;", "removal_reason": null, "collapsed_reason": null, "distinguished": null, "associated_award": null, "stickied": false, "author_premium": false, "can_gild": false, "gildings": {}, "unrepliable_reason": null, "author_flair_text_color": null, "score_hidden": false, "permalink": "/r/cprogramming/comments/1lrkzjb/question_about_realloc/n1bpjjo/", "subreddit_type": "public", "locked": false, "report_reasons": null, "created": 1751644404.0, "author_flair_text": null, "treatment_tags": [], "link_id": "t3_1lrkzjb", "subreddit_name_prefixed": "r/cprogramming", "controversiality": 0, "depth": 0, "author_flair_background_color": null, "collapsed_because_crowd_control": null, "mod_reports": [], "num_reports": null, "ups": 2}}, {"kind": "more", "data": {"count": 8, "name": "t1_n1cs9ei", "id": "n1cs9ei", "parent_id": "t3_1lrkzjb", "depth": 0, "children": ["n1cs9ei", "n1fs1pa", "n1g91pv", "n1cuktr", "n1q24ep"]}}], "before": null}}]